<script>
var svg = d3.select("svg");
var width = svg.node().getBoundingClientRect().width;
var height = svg.node().getBoundingClientRect().height;
var x = d3.scale.linear()
.range([0,width-1])
.domain([0,width-1]);

var textel = svg.select("text");

function brush_fun() {
var x0 = brush.extent()[0];
var x1 = brush.extent()[1];

textel.transition().duration(1000)
.attr("x",x0)
.attr("textLength",x1-x0);
};

var brush = d3.svg.brush()
.x(x)
.extent([0,width/2])
.on("brush", brush_fun);

var brush_g = svg.append("g")
.attr("class", "brush")
.call(brush);

brush_g.selectAll("rect")
.style("height", height-2);

brush_fun();
</script>